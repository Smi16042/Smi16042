if (self.CavalryLogger) { CavalryLogger.start_js(["pbIM7"]); }

__d('MercuryThirdPartyMediaReactShape',['React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({aspectRatio:h.number,height:h.number.isRequired,lockHeight:h.bool.isRequired,width:h.number.isRequired}),j=h.shape({chatImageDimensions:i.isRequired,chatMediaDimensions:i.isRequired,chatTextClasses:h.string,mediaSrc:h.string.isRequired,messengerImageDimensions:i.isRequired,messengerMediaDimensions:i.isRequired,messengerTextClasses:h.string,showMediaWithText:h.bool.isRequired});f.exports=j;}),null);
__d('MercuryThirdPartyMediaAttachmentContent.react',['cx','ix','CenteredContainer.react','ControlledRefererIFrame.react','FBOverlayBase.react','FBOverlayContainer.react','FBOverlayElement.react','Image.react','ImageBlock.react','Link.react','MercuryFallbackShareAttachmentTextBlock.react','MercuryShareAttachmentRenderLocations','MercuryThirdPartyMediaReactShape','React','ReactDOM','ResponsiveBlock.react','URI','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m={IMAGE:'image',MEDIA:'media'};j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=k.constructor).call.apply(p,[this].concat(s)),this.$MercuryThirdPartyMediaAttachmentContent1=function(){this.setState({imageDimensions:this.$MercuryThirdPartyMediaAttachmentContent5(m.IMAGE),mediaDimensions:this.$MercuryThirdPartyMediaAttachmentContent5(m.MEDIA)});}.bind(this),this.$MercuryThirdPartyMediaAttachmentContent4=function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var u=this.$MercuryThirdPartyMediaAttachmentContent5(this.state.showMedia?m.MEDIA:m.IMAGE),v=u.height,w=u.width,x=v>w;return "_3xn3"+(o(v,w)&&!x?' '+"_3xn5":'')+(x?' '+"_3xn6":'')+(w>=v?' '+"_3xn7":'');}.bind(this),this.$MercuryThirdPartyMediaAttachmentContent6=function(u){var v=this.props.media;if(this.$MercuryThirdPartyMediaAttachmentContent7()){return u===m.IMAGE?v.chatImageDimensions:v.chatMediaDimensions;}else return u===m.IMAGE?v.messengerImageDimensions:v.messengerMediaDimensions;}.bind(this),this.$MercuryThirdPartyMediaAttachmentContent5=function(u){var v=this.$MercuryThirdPartyMediaAttachmentContent6(u),w=c('ReactDOM').findDOMNode(this.refs.wrapper);if(w){var x=v.aspectRatio,y=w.offsetWidth;if(x!=null){return {aspectRatio:x,height:y*x,lockHeight:false,width:y};}else if(v.lockHeight){return {aspectRatio:null,height:v.height,lockHeight:true,width:y};}else return v;}else return v;}.bind(this),this.$MercuryThirdPartyMediaAttachmentContent8=function(u){u.preventDefault();this.setState({showMedia:true,iframeWidth:c('ReactDOM').findDOMNode(this.refs.wrapper).offsetWidth});}.bind(this),this.$MercuryThirdPartyMediaAttachmentContent3=function(){var u=this.state.imageDimensions,v={height:u.height,width:u.width};return (c('React').createElement(c('FBOverlayContainer.react'),{className:(this.state.showMedia?"hidden_elem":'')+(' '+"clearfix"),style:v},c('React').createElement(c('FBOverlayBase.react'),null,c('React').createElement(c('Image.react'),{style:v,src:this.props.attachment.media.image})),c('React').createElement(c('FBOverlayElement.react'),null,c('React').createElement(c('CenteredContainer.react'),{vertical:true},c('React').createElement(c('Image.react'),{className:"_4crc",onClick:this.$MercuryThirdPartyMediaAttachmentContent8,src:i('/images/chat/chat_play_icon.png')})))));}.bind(this),this.$MercuryThirdPartyMediaAttachmentContent2=function(){if(!this.state.showMedia)return c('React').createElement('div',null);var u=this.state.mediaDimensions,v=new (c('URI'))(this.props.media.mediaSrc);v.addQueryData({autoplay:true});return (c('React').createElement(c('ControlledRefererIFrame.react'),{allowTransparency:true,frameBorder:0,height:u.height,src:v.toString(),width:u.width,allowFullScreen:true}));}.bind(this),this.$MercuryThirdPartyMediaAttachmentContent7=function(){return this.props.location===c('MercuryShareAttachmentRenderLocations').CHAT;}.bind(this),this.state={showMedia:false,imageDimensions:this.$MercuryThirdPartyMediaAttachmentContent5(m.IMAGE),mediaDimensions:this.$MercuryThirdPartyMediaAttachmentContent5(m.MEDIA)},q;}n.prototype.render=function(){var p=this.props.attachment,q=this.props.location,r=this.props.media,s=(c('MercuryShareAttachmentRenderLocations').CHAT===q?"_49or":'')+(c('MercuryShareAttachmentRenderLocations').MESSENGER===q?' '+"_tih":'')+(!(p&&p.media.image)?' '+"_49ou":'');if(q===c('MercuryShareAttachmentRenderLocations').CHAT){return c('React').createElement(c('ResponsiveBlock.react'),{onResize:this.$MercuryThirdPartyMediaAttachmentContent1,ref:'wrapper',className:r.chatTextClasses},this.$MercuryThirdPartyMediaAttachmentContent2(),c('React').createElement('div',{className:c('joinClasses')(s,this.state.showMedia&&!this.props.media.showMediaWithText?"hidden_elem":''),spacing:'medium'},this.$MercuryThirdPartyMediaAttachmentContent3(),c('React').createElement('div',{className:"_4cra"},c('React').createElement(c('MercuryFallbackShareAttachmentTextBlock.react'),{attachment:p,location:q}))));}else if(q===c('MercuryShareAttachmentRenderLocations').MESSENGER)return c('React').createElement(c('ResponsiveBlock.react'),{onResize:this.$MercuryThirdPartyMediaAttachmentContent1,ref:'wrapper'},c('React').createElement('div',{className:c('joinClasses')(this.props.className,this.$MercuryThirdPartyMediaAttachmentContent4())},this.$MercuryThirdPartyMediaAttachmentContent2(),c('React').createElement('div',{className:this.state.showMedia&&!this.props.media.showMediaWithText?"hidden_elem":''},this.$MercuryThirdPartyMediaAttachmentContent3(),c('React').createElement(c('Link.react'),{className:c('joinClasses')(r.messengerTextClasses,"_5rw4 _vjv"),href:this.props.media.mediaSrc,target:'_blank'},c('React').createElement(c('MercuryFallbackShareAttachmentTextBlock.react'),{attachment:p,location:q})))));};n.propTypes={attachment:l.object.isRequired,location:l.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()).isRequired,media:c('MercuryThirdPartyMediaReactShape').isRequired};function o(p,q){return p<=300&&q<=300;}f.exports=n;}),null);
__d('MercuryYoutubeLinkParser',['MercuryConfig','MercuryShareAttachmentRenderLocations','URI'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h='www.youtube.com',i='m.youtube.com',j='youtu.be',k='https://www.youtube.com/',l='/watch',m={isValidYoutubeLink:function n(o,p){var q=this._getYoutubeURI(p),r=q.getDomain();return ((r===h||r===i||r===j)&&this.getVideoID(q)!==null&&(o===c('MercuryShareAttachmentRenderLocations').MESSENGER||o===c('MercuryShareAttachmentRenderLocations').CHAT));},_getYoutubeURI:function n(o){var p=new (c('URI'))(o);if(this.isShareLink(p))return p;var q=p.getQueryData().u;return q?new (c('URI'))(q):p;},getVideoID:function n(o){var p=o.getPath();if(this.isShareLink(o))return p;if(p===l)return o.getQueryData().v;return null;},getVideoEmbedURI:function n(o,p){if(this.isValidYoutubeLink(o,p)){var q=this._getYoutubeURI(p),r=q.getQueryData().t,s=new (c('URI'))(k).setPath('/embed/'+this.getVideoID(q));if(r!=null){var t=this.shareLinkStartTimeToEmbedStartTime(r);if(t!=null)s.setQueryData({start:t});}return s.toString();}else return '';},isShareLink:function n(o){return o.getDomain()===j;},shareLinkStartTimeToEmbedStartTime:function n(o){var p=o.match(/((\d+)h)?((\d+)m)?((\d+)s)?/);if(p==null||p[0]==='')return null;var q=p[2],r=p[4],s=p[6];return Number(q||0)*3600+Number(r||0)*60+Number(s||0)+'';}};f.exports=m;}),null);
__d('MercuryVideoShareYoutubeAttachment.react',['cx','MercuryFallbackShareAttachment.react','MercuryShareAttachmentRenderLocations','MercuryThirdPartyMediaAttachmentContent.react','MercuryYoutubeLinkParser','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$MercuryVideoShareYoutubeAttachment1=function(){var r={aspectRatio:9/16,height:0,lockHeight:false,width:0};return {chatImageDimensions:r,chatMediaDimensions:r,chatTextClasses:"_3rnp",mediaSrc:c('MercuryYoutubeLinkParser').getVideoEmbedURI(this.props.location,this.props.attachment.uri),messengerImageDimensions:r,messengerMediaDimensions:r,messengerTextClasses:"_3rnq",showMediaWithText:true};}.bind(this),n;}l.prototype.render=function(){if(c('MercuryYoutubeLinkParser').isValidYoutubeLink(this.props.location,this.props.attachment.uri))return c('React').createElement(c('MercuryThirdPartyMediaAttachmentContent.react'),{attachment:this.props.attachment,location:this.props.location,media:this.$MercuryVideoShareYoutubeAttachment1()});return c('React').createElement(c('MercuryFallbackShareAttachment.react'),this.props);};l.propTypes={attachment:k.object.isRequired,location:k.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()).isRequired,maxWidth:k.number};f.exports=l;}),null);